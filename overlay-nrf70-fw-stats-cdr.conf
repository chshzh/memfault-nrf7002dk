#
# Copyright (c) 2025 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#
# nRF70 Firmware Statistics CDR overlay configuration
# Enables collection of nRF70 WiFi firmware stats (PHY, LMAC, UMAC)
# and upload to Memfault via Custom Data Recording (CDR)
#
# WARNING: Memfault CDR is limited to 1 upload per device per 24 hours!
#          Enable Developer Mode in Memfault dashboard for higher limits during testing.
#
# Trigger: Button 1 short press (this is the ONLY trigger for CDR collection)
#
# NOTE: CONFIG_NET_STATISTICS_ETHERNET_VENDOR causes "Stats request already pending"
#       <err> messages during heavy network traffic. These are HARMLESS but noisy.
#       Cannot suppress without disabling all wifi_nrf logs (CONFIG_WIFI_NRF70_LOG_LEVEL_OFF=y).
#       This is a driver issue - should be log_dbg not log_err.
#
# Build with:
#   west build -b nrf7002dk/nrf5340/cpuapp -- \
#     -DSB_CONFIG_NETCORE_HCI_IPC=y \
#     -DEXTRA_CONF_FILE="overlay-ble-prov.conf;overlay-nrf70-fw-stats-cdr.conf"
#

# Enable Memfault CDR (Custom Data Recording)
CONFIG_MEMFAULT_CDR_ENABLE=y

# Enable WiFi vendor statistics collection (nRF70 FW stats)
CONFIG_NET_STATISTICS=y
CONFIG_NET_STATISTICS_USER_API=y
CONFIG_NET_STATISTICS_ETHERNET=y
CONFIG_NET_STATISTICS_ETHERNET_VENDOR=y

# Note: The "Stats request already pending" errors are logged as ERR level
# and cannot be suppressed without CONFIG_WIFI_NRF70_LOG_LEVEL_OFF=y (not recommended).
# These errors are HARMLESS - the CDR button press collection will still work.

# Enable nRF70 FW stats CDR feature
CONFIG_NRF70_FW_STATS_CDR_ENABLED=y

