#
# Copyright (c) 2025 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#
# BLE Provisioning overlay configuration for memfault-nrf7002dk
# Use with: west build -- -DOVERLAY_CONFIG=overlay-ble-prov.conf
#

# Enable BLE Provisioning
CONFIG_BT_WIFI_PROV=y
CONFIG_WIFI_PROV_CORE=y
CONFIG_BT_WIFI_PROV_LOG_LEVEL_INF=y

# BLE Core Configuration
CONFIG_BT=y
CONFIG_BT_SMP=y
CONFIG_BT_PERIPHERAL=y

# BLE Buffer Configuration
CONFIG_BT_BUF_ACL_RX_SIZE=151
CONFIG_BT_L2CAP_TX_MTU=147
CONFIG_BT_BUF_ACL_TX_SIZE=151

# Increased BT RX stack size because BLE and Wi-Fi operations
# run in the same BT RX workqueue thread during provisioning.
CONFIG_BT_RX_STACK_SIZE=22000
CONFIG_BT_BONDABLE=n
CONFIG_BT_DEVICE_NAME_DYNAMIC=y

# Setting BT supervision timeout to 75 units (750ms) to avoid timeout of BT connection
# when radio is granted to Wi-Fi during scan.
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=75

# Protocol Buffers support (required for BLE provisioning)
CONFIG_NANOPB=y

# Reduce heap size to fit in flash - BLE provisioning uses less heap than original sample
CONFIG_HEAP_MEM_POOL_SIZE=40144

# Network Management Event Queue
CONFIG_NET_MGMT_EVENT_QUEUE_TIMEOUT=5000

# Disable shell to save flash when BLE provisioning is enabled
CONFIG_SHELL=n
CONFIG_MEMFAULT_SHELL=n
CONFIG_NET_L2_WIFI_SHELL=n
CONFIG_NET_SHELL=n

# Enable BLE provisioning specific feature
CONFIG_BLE_PROV_ENABLED=y
